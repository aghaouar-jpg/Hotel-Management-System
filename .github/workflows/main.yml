name: Java CI with OpenJML

on:
  push:
    branches: [ main, open-jml ]
  pull_request:
    branches: [ main ]

jobs:
  openjml-verification:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Java
        uses: actions/setup-java@v3
        with:
          distribution: temurin
          java-version: 21

      - name: Download OpenJML
        run: |
          wget https://github.com/OpenJML/OpenJML/releases/download/21-0.18/openjml-ubuntu-22.04-21-0.18.zip
          unzip openjml-ubuntu-22.04-21-0.18.zip

      - name: Run OpenJML verification
        run: |
          ./openjml/openjml \
            --esc \
            -cp "HotelManagementSystem/lib/*" \
            $(find HotelManagementSystem/src -name "*.java")
